!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ShareThis=t()}(this,function(){"use strict";function e(e){return{left:e.pageXOffset,top:e.pageYOffset}}function t(e,t){return v||(v=o(e)),e[v](t)}function n(e,n){for(var r=e;r&&(1!==r.nodeType||!t(r,n));)r=r.parentNode;return r}function r(e,t){var n=e.compareDocumentPosition(t);return!n||(16&n)>0}function o(e){for(var t=["matches","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],n=0;n<t.length;n++){var r=t[n];if(e[r])return r}}function i(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.name===t)return r}}function a(e,t){if(t&&"object"===("undefined"==typeof t?"undefined":m(t)))for(var n in t)e[n]=t[n];return e}function c(e){return"function"==typeof e}function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function u(e){if(e.isCollapsed)return!0;var t=e.anchorNode.compareDocumentPosition(e.focusNode);return t?(4&t)>0:e.anchorOffset<e.focusOffset}function l(e,t){var n=void 0,r=e.getClientRects();if(t){for(var o=1/0,i=r.length;i--;){var a=r[i];if(a.left>o)break;o=a.left}n=g.call(r,i+1)}else{for(var c=-(1/0),u=0;u<r.length;u++){var l=r[u];if(l.right<c)break;c=l.right}n=g.call(r,0,u)}return{top:Math.min.apply(Math,f(n.map(function(e){return e.top}))),bottom:Math.max.apply(Math,f(n.map(function(e){return e.bottom}))),left:n[0].left,right:n[n.length-1].right}}function s(e,t){var o=e.cloneRange();if(e.collapsed||!t)return o;var i=n(e.startContainer,t);return i?r(i,e.endContainer)||o.setEnd(i,i.childNodes.length):(i=n(e.endContainer,t),i?o.setStart(i,0):o.collapse()),o}function p(t,n,r){var o=r.document,i=o.defaultView,a=i.getSelection(),c=u(a),f=l(n,c),s=e(i),p=t.style;c?p.right=o.documentElement.clientWidth-f.right-s.left+"px":p.left=s.left+f.left+"px",p.width=f.right-f.left+"px",p.height=f.bottom-f.top+"px",p.top=s.top+f.top+"px",p.position="absolute",t.className=r.popoverClass}function d(e,t){var r=n(t.target,"["+y+"]");if(r){var o=r.getAttribute(y),a=i(e,o);a&&c(a.action)&&a.action(t,r)}}function h(e){return{createPopover:function(){var t=e.createElement("div");return t.addEventListener("click",function(e){d(this.sharers,e)}),t},attachPopover:function(t){e.body.appendChild(t)},removePopover:function(e){var t=e.parentNode;t&&t.removeChild(e)}}}var v=void 0,m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g=Array.prototype.slice,y="data-share-via",b=function(e,t,n,r){var o=e.shareUrl||e.document.defaultView.location;return"<ul>"+t.map(function(e){return'<li data-share-via="'+e.name+'">'+e.render.call(e,n,r,o)+"</li>"}).join("")+"</ul>"},S=void 0,C=["selectionchange","mouseup","touchend","touchcancel"],E=function(e){function t(e){g.addEventListener(e,o)}function n(e){g.removeEventListener(e,o)}function r(){E&&p(E,i(),d)}function o(e){var t=e.type,n="selectionchange"===t;!E!==n&&setTimeout(function(){var e=i();e?f(e):u()},10)}function i(){var e=y.getSelection(),t=e.rangeCount&&e.getRangeAt(0);if(t){var n=s(t,d.selector);if(!n.collapsed)return n}}function f(e){var t=!E,n=e.toString(),r=d.transformer(n),o=d.sharers.filter(l.bind(null,r,n));return o.length?(t&&(E=M.createPopover()),E.sharers=o,E.innerHTML=b(d,o,r,n),p(E,e,d),void(t&&(M.attachPopover(E),c(d.onOpen)&&d.onOpen(E,r,n)))):void(E&&u())}function u(){E&&(M.removePopover(E),E=S,c(d.onClose)&&d.onClose())}function l(e,t,n){var r=n.active;return c(r)?r(e,t):r===S||r}var d=(Object.assign||a)({document:document,selector:"body",sharers:[],popoverClass:"share-this-popover",transformer:function(e){return e.trim().replace(/\s+/g," ")}},e||{}),v=!1,m=!1,g=S,y=S,E=S,M=S;return{init:function(){return!v&&(g=d.document,y=g.defaultView,y.getSelection?(C.forEach(t),y.addEventListener("resize",r),M=h(g),v=!0):(console.warn("share-this: Selection API isn't supported"),!1))},destroy:function(){return!(!v||m)&&(C.forEach(n),y.removeEventListener("resize",r),u(),g=S,y=S,m=!0)}}};return E});